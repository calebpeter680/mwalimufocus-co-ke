{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXNCD5KZR9" defer></script>
    <script>
      function initializeGA() {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-XXNCD5KZR9', {
          'transport_type': 'beacon'
        });
      }
    </script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Exam and Assignment Generator App * MwalimuFocus.Co.Ke</title>


    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap-icons.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">


    <link rel="icon" href="{% static 'img/favicon-32x32.png' %}" sizes="32x32" type="image/png">

    <link rel="icon" href="{% static 'img/favicon-16x16.png' %}" sizes="16x16" type="image/png">

  </head>
  <body class="bg-body-tertiary">
    <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
      <symbol id="bi-journal-code" viewBox="0 0 16 16">
        <path fill-rule="evenodd" d="M8.646 5.646a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1 0 .708l-2 2a.5.5 0 0 1-.708-.708L10.293 8 8.646 6.354a.5.5 0 0 1 0-.708m-1.292 0a.5.5 0 0 0-.708 0l-2 2a.5.5 0 0 0 0 .708l2 2a.5.5 0 0 0 .708-.708L5.707 8l1.647-1.646a.5.5 0 0 0 0-.708"/>
        <path d="M3 0h10a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-1h1v1a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v1H1V2a2 2 0 0 1 2-2"/>
        <path d="M1 5v-.5a.5.5 0 0 1 1 0V5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 3v-.5a.5.5 0 0 1 1 0V8h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1zm0 3v-.5a.5.5 0 0 1 1 0v.5h.5a.5.5 0 0 1 0 1h-2a.5.5 0 0 1 0-1z"/>
      </symbol>
    </svg>

    <nav class="navbar navbar-expand-lg navbar-light bg-light text-center" style="padding-top: 0.1rem; padding-bottom: 0.1rem;">
      <div class="container-fluid">
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <ul class="navbar-nav me-auto mb-2 mb-lg-0 flex-lg-row"> <!-- Remove 'flex-column' class -->
                <li class="nav-item">
                    <a class="nav-link" href="tel:{{ brand.phone_number }}" style="font-size: 0.9rem;">
                        <i class="bi bi-telephone"></i> {{ brand.phone_number }}
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="mailto:{{ brand.email }}" style="font-size: 0.9rem;">
                        <i class="bi bi-envelope"></i> {{ brand.email }}
                    </a>
                </li>
              </ul>
          </div>
      </div>
    </nav>



    <nav class="navbar sticky-top navbar-expand-lg navbar-light" style="background: {{ brand.primary_color }};">
      <div class="container-fluid">
        <a class="navbar-brand" href="/">
          <img src="{% static 'img/logo.webp' %}" alt="MwalimuFocus.Co.Ke" height="70" width="170" loading="lazy">
        </a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent1" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">

          <span class="navbar-toggler-icon"></span>

        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent1">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="/">Home</a>
            </li>
            {% for item in menu_items %}
            <li class="nav-item">
              <a class="nav-link" href="/categories/{{ item.slug }}">{{ item.name }}</a>
            </li>
            {% endfor %}
          </ul>

          <ul class="navbar-nav">
            {% if user.is_authenticated %}
                <li>
                  <div class="dropdown">
                    <button class="btn btn-dark dropdown-toggle" type="button" data-bs-toggle="dropdown" data-bs-display="static" aria-expanded="false">
                      <i class="bi bi-person-circle"></i> My Profile
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end dropdown-menu-lg-start">
                      <li><a class="dropdown-item" href="/accounts/dashboard/">Dashboard</a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item" href="{% url 'logout' %}">Logout</a></li>
                    </ul>
                  </div>
                </li>
            {% else %}
                <li>
                    <button class="btn btn-dark" data-bs-target="#accountModal" data-bs-toggle="modal">My Account</button>
                </li>
            {% endif %}
          </ul>

        </div>
      </div>
    </nav>

    <!-- Start of Container -->
    <div class="container my-5">

      <div class="position-relative text-center text-muted bg-body-tertiary border border-dashed rounded-5">
        <svg class="bi mt-5 mb-3" width="48" height="48"><use xlink:href="#bi-journal-code"/></svg>
        <h1 class="mb-3 mt-3 text-body-emphasis" style="font-size: 32px;"><b>Exam Generator App for CBC and 8-4-4 Exams and Assignments in Kenya</b></h1>
        <p class="col-lg-6 mx-auto mb-4" style="font-size: 18px;">
          Our world-class exam/assignment generator app can help teachers, parents, and students to generate CBC and 8-4-4 <b>exams and assignments</b> instantly without waiting! Exams or assignments are generated together with their <b>marking schemes/answers</b>. 
        </p>
        <div class="col">
            <button id="generate_now" class="btn btn-dark px-5 mb-3" type="button"><b>Generate Now!</b></button>
            <div class="mt-3"></div> 
            <p class="text-center" style="font-weight: bold;">OR</p>
            <button class="btn btn-outline-dark px-5 mb-3" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasWithBothOptions" aria-controls="offcanvasWithBothOptions"><b>Learn How It Works</b></button>
        </div>


      </div>

      <div class="offcanvas offcanvas-start bg-body-tertiary" data-bs-scroll="true" tabindex="-1" id="offcanvasWithBothOptions" aria-labelledby="offcanvasWithBothOptionsLabel">
        <div class="offcanvas-header">
          <h2 class="offcanvas-title" id="offcanvasWithBothOptionsLabel" style="line-height: 1; font-size: 20px;"><b>How Exam Generator App Works: Step by Step</b></h2>
          <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
          <ul class="list-group list-group-flush">
            <li class="list-group-item">
                <div class="row align-items-center">
                    <div class="col-auto">
                        <i class="bi bi-1-circle"></i>
                    </div>
                    <div class="col">
                        Click on <b>"Generate Now!"</b> button.
                    </div>
                </div>
            </li>
            <li class="list-group-item">
                <div class="row align-items-center">
                    <div class="col-auto">
                        <i class="bi bi-2-circle"></i>
                    </div>
                    <div class="col">
                        Fill the form to <b>customize your exam/assignment</b>.
                    </div>
                </div>
            </li>
            <li class="list-group-item">
                <div class="row align-items-center">
                    <div class="col-auto">
                        <i class="bi bi-3-circle"></i>
                    </div>
                    <div class="col">
                        Click on <b>"Generate"</b> button to submit the form.
                    </div>
                </div>
            </li>
            <li class="list-group-item">
                <div class="row align-items-center">
                    <div class="col-auto">
                        <i class="bi bi-4-circle"></i>
                    </div>
                    <div class="col">
                        You will be redirected to a status page that will show a <b>preview of the generated exam/assignment and its marking scheme/answers.</b>
                    </div>
                </div>
            </li>
            <li class="list-group-item">
                <div class="row align-items-center">
                    <div class="col-auto">
                        <i class="bi bi-5-circle"></i>
                    </div>
                    <div class="col">
                        To download, click on <b>"Pay Now"</b> button and pay the due amount.
                    </div>
                </div>
            </li>
          </ul>
        </div>
      </div>

      <hr style="height: 10px; border: none; border-top: 3px dashed;">

      <div id="exam_gen_form_container" class="container">
        <main>
          <div class="py-5 text-center">
            <h2>Exam/Assignment Generation Form</h2>
            <p class="lead">Fill the form below to create a custom exam or assignment. Once you're done, click "Generate" button to proceed to the preview!</p>
          </div>

          <div class="row g-5">
            <div class="col-md-12 col-lg-12">
              <h4 class="mb-3">Exam/Assignment Details</h4>

              <form id="exam_gen_form" class="form_needs-validation">
                {% csrf_token %}
                <div class="row g-3">
                  <div class="col-sm-6">
                    <label for="school_name" class="form-label">School Name</label>
                    <input type="text" class="form-control" id="school_name" name="school_name" placeholder="e.g., Alliance High School" value="" required>
                    <div class="invalid-feedback">
                      Valid school name is required.
                    </div>
                  </div>

                  <div class="col-sm-3">
                    <label for="academic_term" class="form-label">Academic Term</label>
                    <select class="form-select" id="academic_term" name="academic_term" required>
                      <option value="Term 1">Term 1</option>
                      <option value="Term 2">Term 2</option>
                      <option value="Term 3">Term 3</option>
                    </select>
                    <div class="invalid-feedback">
                      Please provide a valid academic term.
                    </div>
                  </div>

                  <div class="col-sm-3">
                    <label for="assessment_type" class="form-label">Type of Assessment</label>
                    <select class="form-select" id="assessment_type" name="assessment_type" required>
                      <option value="Exam">Exam</option>
                      <option value="Assignment">Assignment</option>
                    </select>
                    <div class="invalid-feedback">
                      Please provide a valid type of assessment.
                    </div>
                  </div>

                  <div class="col-sm-4">
                    <label for="education_level" class="form-label">Education Level</label>
                    <select class="form-select" id="education_level" name="education_level" required>
                      {% if education_levels %}
                        {% for e in education_levels %}
                        <option value="{{ e.id }}">{{ e.name }}</option>
                        {% endfor %}
                      {% endif %}
                    </select>
                    <div class="invalid-feedback">
                      Please provide a valid education level.
                    </div>
                  </div>

                  <div class="col-sm-4">
                    <label for="exam_type" class="form-label">Exam Type</label>
                    <select class="form-select" id="exam_type" name="exam_type" required>
                      <option value="Opener">Opener</option>
                      <option value="Midterm">Midterm</option>
                      <option value="Endterm">Endterm</option>
                    </select>
                    <div class="invalid-feedback">
                      Please provide a valid academic term.
                    </div>
                  </div>

                  <div class="col-sm-4">
                    <label for="subjects" class="form-label">Subject</label>
                    <select class="form-select" id="subjects" name="subjects" required>
                      {% if subjects %}
                        {% for s in subjects %}
                      <option value="{{ s.id }}">{{ s.name }}</option>
                        {% endfor %}
                      {% endif %}
                    </select>
                    <div class="invalid-feedback">
                      Please provide a valid subject.
                    </div>
                  </div>


                  <div class="col-sm-3">
                    <label for="month" class="form-label">Month</label>
                    <select class="form-select" id="month" name="month" required>
                      <option value="Jan">Jan</option>
                      <option value="Feb">Feb</option>
                      <option value="Mar">Mar</option>
                      <option value="Apr">Apr</option>
                      <option value="May">May</option>
                      <option value="Jun">Jun</option>
                      <option value="Jul">Jul</option>
                      <option value="Aug">Aug</option>
                      <option value="Sep">Sep</option>
                      <option value="Oct">Oct</option>
                      <option value="Nov">Nov</option>
                      <option value="Dec">Dec</option>
                    </select>
                    <div class="invalid-feedback">
                      Please provide a valid month.
                    </div>
                  </div>

                  <div class="col-sm-3">
                    <label for="year" class="form-label">Year</label>
                    <input type="text" class="form-control" id="year" name="year" placeholder="e.g., 2024" value="" required>
                    <div class="invalid-feedback">
                      Valid year is required.
                    </div>
                  </div>

                  <div class="col-sm-3">
                    <label for="exam_duration" class="form-label">Exam Duration</label>
                    <select class="form-select" id="exam_duration" name="exam_duration" required>
                      <option value="1h 45 Mins">1h 45 Mins</option>
                      <option value="15 minutes">15 Minutes</option>
                      <option value="30 Minutes">30 Minutes</option>
                      <option value="45 Minutes">45 Minutes</option>
                      <option value="1 Hour">1 Hour</option>
                      <option value="1h 15 Mins">1h 15 Mins</option>
                      <option value="1h 30 Mins">1h 30 Mins</option>
                      <option value="2 Hours">2 Hours</option>
                      <option value="2h 15 Mins">2h 15 Mins</option>
                      <option value="2h 30 Mins">2h 30 Mins</option>
                      <option value="2h 45 Mins">2h 45 Mins</option>
                      <option value="3 Hours">3 Hours</option>
                    </select>
                    <div class="invalid-feedback">
                      Please provide a valid academic term.
                    </div>
                  </div>

                  <div class="col-sm-3">
                    <label for="max_score" class="form-label">Maximum Score</label>
                    <select class="form-select" id="max_score" name="max_score" required>
                      <option value="50">50 Marks</option>
                      <option value="10">10 Marks</option>
                      <option value="20">20 Marks</option>
                      <option value="30">30 Marks</option>
                      <option value="40">40 Marks</option>
                      <option value="60">60 Marks</option>
                      <option value="70">70 Marks</option>
                      <option value="80">80 Marks</option>
                      <option value="90">90 Marks</option>
                      <option value="100">100 Marks</option>
                      <option value="110">110 Marks</option>
                      <option value="120">120 Marks</option>
                    </select>
                    <div class="invalid-feedback">
                      Please provide a valid academic term.
                    </div>
                  </div>

                  <div class="col-md-6">
                    <h5 class="mb-3">Select Applicable Instructions to Examinees</h5>
                    <div id="instructions-container">
                      {% if instructions_to_examinees %}
                        {% for i in instructions_to_examinees %}
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="checkbox" id="instructions{{ i.id }}" name="instructions" value="{{ i.id }}">
                          <label class="form-check-label" for="instructions{{ i.id }}">{{ i.text }}</label>
                        </div>
                        {% endfor %}
                      {% endif %}
                    </div>
                    <div class="invalid-feedback">
                      <i class="bi bi-exclamation-circle"></i> Please select at least one instruction.
                    </div>
                  </div>

                  <div class="col-md-6">
                    <h5 class="mb-3">Select Topics for the Exam or Assignment</h5>
                    <div id="topics-container">
                      <!-- Topics checkboxes will be populated here -->
                    </div>
                    <div class="invalid-feedback">
                      <i class="bi bi-exclamation-circle"></i> Please select at least one topic.
                    </div>
                  </div>
                </div>

                <hr class="my-4">

                <button id="generate_exam_submit_btn" class="mt-4 mb-4 w-100 btn btn-dark btn-lg" type="submit">Generate</button>
              </form>
            </div>
          </div>
        </main>
      </div>
      

    </div>
    <!-- End of Container -->


    <div class="container">
      <footer class="py-5">
        <div class="row">
          <div class="col-12 col-md-3 mb-3">
            <h5>Quick Links</h5>
            <ul class="nav flex-column">
              <li class="nav-item mb-2">
                <a href="/categories/" style="text-decoration: none; color: blue;">All Categories</a>
              </li>
              {% for item in categories_with_items %}
              <li class="nav-item mb-2">
                <a href="/categories/{{ item.slug }}/" style="text-decoration: none; color: blue;">{{ item.name }}</a>
              </li>
              {% endfor %}
            </ul>
          </div>


          <div class="col-12 col-md-3 mb-3">
            <h5>Contact Us</h5>
            <ul class="nav flex-column">
              <li class="nav-item mb-2"><a href="tel:{{ brand.phone_number }}" class="nav-link p-0 text-body-secondary"><i class="bi bi-telephone"></i> {{ brand.phone_number }}</a></li>
              <li class="nav-item mb-2"><a href="mailto:{{ brand.email }}" class="nav-link p-0 text-body-secondary email-link"><i class="bi bi-envelope"></i> {{ brand.email }}</a></li>
            </ul>
            <h5>Programs & Apps</h5>
            <ul class="nav flex-column">
              <li class="nav-item mb-2"><a href="{% url 'exam_generator_form' %}" style="text-decoration: none; color: blue;">Exam Generator</a></li>
            </ul>
          </div>

          <div class="col-md-5 offset-md-1 mb-3 subscriber-creation-div">
            <h5>Subscribe to our newsletter</h5>
            <p>Monthly digest of what's new and exciting from us.</p>
            <div class="input-group">
                <input id="newsletterEmail" type="text" class="form-control" placeholder="Email address">
                <button id="subscribeButton" class="btn btn-dark">Subscribe</button>
            </div>
            <div id="subscriptionMessageContainer" class="mt-2"></div>
          </div>
        </div>

        <div class="d-flex flex-column flex-sm-row justify-content-between py-4 my-4 border-top">
          <div class="container">
            <div class="row">
                <div class="col">
                    <p>&copy; 2024 MwalimuFocus.Co.Ke. All rights reserved.</p>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <p>MwalimuFocus.Co.Ke collaborates with professional teachers across Kenya to outsource high-quality schemes of work, lesson plans, lesson notes, revision booklets, and past papers with marking schemes. Kenyan teachers, parents, and students can download these materials from our website for FREE or at a small fee. Learn more <a href="/about-us/" style="text-decoration: none; color: blue;">about us.</a></p>
                </div>
            </div>
            <div class="row">
              <div class="col-lg-1 col-md-6 col-sm-6">
                  <p><a href="/terms-and-conditions/" style="text-decoration: none; color: blue;">Terms</a></p>
              </div>
              <div class="col-lg-1 col-md-6 col-sm-6">
                  <p><a href="/privacy-policy/" style="text-decoration: none; color: blue;">Privacy</a></p>
              </div>
            </div>
          </div>

          {% if latest_link %}
          <ul class="list-unstyled d-flex">
              {% if latest_link.facebook_url %}
                  <li class="ms-3" style="font-size: 20px;">
                      <a class="link-body-emphasis" href="{{ latest_link.facebook_url }}" target="_blank">
                          <i class="bi bi-facebook"></i>
                      </a>
                  </li>
              {% endif %}
              {% if latest_link.telegram_url %}
                  <li class="ms-3" style="font-size: 20px;">
                      <a class="link-body-emphasis" href="{{ latest_link.telegram_url }}" target="_blank">
                          <i class="bi bi-telegram"></i>
                      </a>
                  </li>
              {% endif %}
              {% if latest_link.whatsapp_url %}
                  <li class="ms-3" style="font-size: 20px;">
                      <a class="link-body-emphasis" href="{{ latest_link.whatsapp_url }}" target="_blank">
                          <i class="bi bi-whatsapp"></i>
                      </a>
                  </li>
              {% endif %}
          </ul>
          {% endif %}
        </div>
      </footer>
    </div>



   









    <!-- First Modal - Account Activity Selection -->
    <div class="modal fade" id="accountModal" aria-hidden="true" aria-labelledby="accountModalLabel" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header text-center">
                    <p class="modal-title" id="accountModalLabel" style="font-size: 24px;">I want to:</p>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <button class="btn btn-dark" data-bs-target="#registerModal" data-bs-toggle="modal" data-bs-dismiss="modal">Register</button>
                    <button class="btn btn-dark" data-bs-target="#loginModal" data-bs-toggle="modal" data-bs-dismiss="modal">Login</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Second Modal - Register or Login -->
    <div class="modal fade" id="registerModal" aria-hidden="true" aria-labelledby="registerModalLabel" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <p class="modal-title" id="registerModalLabel" style="font-size: 24px;">Register as:</p>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <button class="btn btn-dark" data-bs-target="#customerRegisterModal" data-bs-toggle="modal" data-bs-dismiss="modal">Customer</button>
                    <button class="btn btn-dark" data-bs-target="#vendorRegisterModal" data-bs-toggle="modal" data-bs-dismiss="modal">Vendor</button>
                </div>
                <div class="modal-footer">
                  <button class="btn btn-outline-dark" data-bs-target="#accountModal" data-bs-toggle="modal">Back</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Third Modal - Customer Registration Form -->
    <div class="modal fade" id="customerRegisterModal" aria-hidden="true" aria-labelledby="customerRegisterModalLabel" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <p class="modal-title" id="customerRegisterModalLabel" style="font-size: 24px;">Customer Registration</p>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body customer_registration_modal">
                    <form id="customerRegistrationForm" method="post">
                      {% csrf_token %}
                      <div class="mb-3">
                          <label for="emailInput1" class="form-label">Email Address (required)</label>
                          <input type="email" class="form-control" id="emailInput1" name="email" required>
                      </div>
                      <div class="mb-3">
                          <label for="passwordInput1" class="form-label">Password (required)</label>
                          <input type="password" class="form-control" id="passwordInput1" name="password" required>
                      </div>
                      <div class="mb-3">
                          <label for="phoneNumberInput1" class="form-label">Phone Number (optional)</label>
                          <input type="tel" class="form-control" id="phoneNumberInput1" name="phone_number">
                      </div>
                      <div class="mb-3 form-check">
                          <input type="checkbox" class="form-check-input" id="agreeTermsInput1" name="agree_to_terms" checked>
                          <label class="form-check-label" for="agreeTermsInput1">Agree to Terms</label>
                      </div>
                      <input type="hidden" name="is_vendor" value="False">

                      <button type="submit" class="btn btn-dark" id="registerCustomerBtn">Register</button>
                    </form>
                </div>
                <div class="modal-footer">
                  <button class="btn btn-outline-dark" data-bs-target="#registerModal" data-bs-toggle="modal">Back</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Fourth Modal - Vendor Registration Form -->
    <div class="modal fade" id="vendorRegisterModal" aria-hidden="true" aria-labelledby="vendorRegisterModalLabel" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <p class="modal-title" id="vendorRegisterModalLabel" style="font-size: 24px;">Vendor Registration</p>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="vendor-registration-modal modal-body">
                  <form id="registrationForm" method="post">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label for="emailInput" class="form-label">Email Address (required)</label>
                        <input type="email" class="form-control" id="emailInput" name="email" required>
                    </div>
                    <div class="mb-3">
                        <label for="passwordInput" class="form-label">Password (required)</label>
                        <input type="password" class="form-control" id="passwordInput" name="password" required>
                    </div>
                    <div class="mb-3">
                        <label for="phoneNumberInput" class="form-label">Phone Number (optional)</label>
                        <input type="tel" class="form-control" id="phoneNumberInput" name="phone_number">
                    </div>
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="agreeTermsInput" name="agree_to_terms" checked>
                        <label class="form-check-label" for="agreeTermsInput">Agree to Terms</label>
                    </div>
                    <input type="hidden" name="is_vendor" value="True">

                    <button type="submit" class="btn btn-dark" id="registerBtn">Register</button>
                  </form>
                </div>

                <div class="modal-footer">
                  <button class="btn btn-outline-dark" data-bs-target="#registerModal" data-bs-toggle="modal">Back</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Fifth Modal - Login -->
    <div class="modal fade" id="loginModal" aria-hidden="true" aria-labelledby="loginModalLabel" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <p class="modal-title" id="loginModalLabel" style="font-size: 24px;">Login</p>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body login-modal">
                    <form>
                      <div class="mb-3">
                        <label for="InputEmail2" class="form-label">Email address</label>
                        <input type="email" class="form-control" id="InputEmail2" aria-describedby="emailHelp">
                      </div>
                      <div class="mb-3">
                        <label for="InputPassword2" class="form-label">Password</label>
                        <input type="password" class="form-control" id="InputPassword2">
                      </div>
                      <button type="submit" class="btn btn-dark" id="loginBtn">Submit</button>
                    </form>
                </div>
                <div class="modal-footer d-flex justify-content-between">
                    <a href="{% url 'reset_password' %}" class="text-decoration-none">Forgot Password</a>
                    <button class="btn btn-outline-dark" data-bs-target="#accountModal" data-bs-toggle="modal">Back</button>
                </div>

            </div>
        </div>
      </div>
    </div>
    <script src="{% static 'js/popper.min.js' %}" defer></script>
    <script src="{% static 'js/bootstrap.min.js' %}" defer></script>
    <script src="{% static 'js/jquery-3.7.1.min.js' %}"></script>
    <script defer src="{% static 'js/sign_up.js' %}"></script>
    <script defer src="{% static 'js/login.js' %}"></script>
    <script src="{% static 'js/image_url_format.js' %}"></script>
    <script defer src="{% static 'js/newsletter.js' %}"></script>
    <script>
      $(document).ready(function() {
          function getRelevantEducationLevels(selectedLevel) {
              const levelMapping = {
                  'PP1': ['PP1'],
                  'PP2': ['PP1', 'PP2'],
                  'Grade 1': ['Grade 1'],
                  'Grade 2': ['Grade 1', 'Grade 2'],
                  'Grade 3': ['Grade 1', 'Grade 2', 'Grade 3'],
                  'Grade 4': ['Grade 4'],
                  'Grade 5': ['Grade 4', 'Grade 5'],
                  'Grade 6': ['Grade 4', 'Grade 5', 'Grade 6'],
                  'Grade 7': ['Grade 7'],
                  'Grade 8': ['Grade 7', 'Grade 8'],
                  'Grade 9': ['Grade 7', 'Grade 8', 'Grade 9'],
                  'Grade 10': ['Grade 10'],
                  'Grade 11': ['Grade 10', 'Grade 11'],
                  'Grade 12': ['Grade 10', 'Grade 11', 'Grade 12'],
                  'Form 1': ['Form 1'],
                  'Form 2': ['Form 1', 'Form 2'],
                  'Form 3': ['Form 1', 'Form 2', 'Form 3'],
                  'Form 4': ['Form 1', 'Form 2', 'Form 3', 'Form 4']
              };

              return levelMapping[selectedLevel] || [];
          }

          function fetchTopics() {
              var educationLevelId = $('#education_level').val();
              var subjectId = $('#subjects').val();

              if (educationLevelId && subjectId) {
                  var selectedLevelText = $('#education_level option:selected').text();
                  var relevantLevels = getRelevantEducationLevels(selectedLevelText);

                  $.ajax({
                      url: '{% url "fetch_topics" %}',
                      data: {
                          'education_level_ids': relevantLevels,
                          'subject_id': subjectId
                      },
                      success: function(data) {
                          var topicsContainer = $('#topics-container');
                          topicsContainer.empty();
                          var noTopics = true;

                          relevantLevels.forEach(function(level) {
                              var levelHeader = `<h6><b>${level}</b></h6>`;
                              topicsContainer.append(levelHeader);
                              var levelTopics = data.topics.filter(topic => topic.education_level === level);
                              if (levelTopics.length > 0) {
                                  noTopics = false;
                                  levelTopics.forEach(function(topic) {
                                      var checkbox = `
                                          <div class="form-check form-check-inline">
                                              <input class="form-check-input" type="checkbox" id="topic${topic.id}" value="${topic.id}">
                                              <label class="form-check-label" for="topic${topic.id}">${topic.name}</label>
                                          </div>`;
                                      topicsContainer.append(checkbox);
                                  });
                              } else {
                                  topicsContainer.append(`<p>No topics yet!</p>`);
                              }
                          });

                          if (noTopics) {
                              topicsContainer.append(`<p><i class="bi bi-patch-exclamation"></i> No topics yet for ${selectedLevelText} ${$('#subjects option:selected').text()}. Please try again soon!</p>`);
                              $('#generate_exam_submit_btn').prop('disabled', true);
                          } else {
                              $('#generate_exam_submit_btn').prop('disabled', false);
                          }
                      }
                  });
              }
          }

          fetchTopics();

          $('#education_level, #subjects').change(function() {
              fetchTopics();
          });
      });
    </script>

    <script>
      (() => {
        'use strict';

        const forms = document.querySelectorAll('.form_needs-validation');

        Array.from(forms).forEach(form => {
          form.addEventListener('submit', event => {
            const instructionsCheckboxes = form.querySelectorAll('#instructions-container input[type="checkbox"]');
            const isAnyInstructionsChecked = Array.from(instructionsCheckboxes).some(checkbox => checkbox.checked);

            if (!isAnyInstructionsChecked) {
              event.preventDefault();
              event.stopPropagation();

              form.querySelector('#instructions-container').classList.add('is-invalid');
              form.querySelector('#instructions-container .invalid-feedback').style.display = 'block';
            } else {
              form.querySelector('#instructions-container').classList.remove('is-invalid');
              form.querySelector('#instructions-container .invalid-feedback').style.display = 'none';
            }

            form.classList.add('was-validated');
          }, false);

          form.querySelectorAll('#instructions-container input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', () => {
              const checkboxes = form.querySelectorAll('#instructions-container input[type="checkbox"]');
              const isAnyCheckboxChecked = Array.from(checkboxes).some(checkbox => checkbox.checked);

              if (isAnyCheckboxChecked) {
                form.querySelector('#instructions-container').classList.remove('is-invalid');
                form.querySelector('#instructions-container .invalid-feedback').style.display = 'none';
              }
            });
          });

          form.querySelector('#instructions-container .invalid-feedback').style.display = 'none';
        });
      })();
    </script>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        'use strict';

        const forms = document.querySelectorAll('.form_needs-validation');

        Array.from(forms).forEach(form => {
          form.addEventListener('submit', event => {
            // Checkboxes for topics
            const topicsCheckboxes = form.querySelectorAll('#topics-container input[type="checkbox"]');
            const isAnyTopicsChecked = Array.from(topicsCheckboxes).some(checkbox => checkbox.checked);

            if (!isAnyTopicsChecked) {
              event.preventDefault();
              event.stopPropagation();

              form.querySelector('#topics-container').classList.add('is-invalid');
              form.querySelector('#topics-container .invalid-feedback').style.display = 'block';
            } else {
              form.querySelector('#topics-container').classList.remove('is-invalid');
              form.querySelector('#topics-container .invalid-feedback').style.display = 'none';
            }

            form.classList.add('was-validated');
          }, false);

          // Use event delegation to handle checkbox changes
          form.querySelector('#topics-container').addEventListener('change', event => {
            if (event.target.matches('input[type="checkbox"]')) {
              const checkboxes = form.querySelectorAll('#topics-container input[type="checkbox"]');
              const isAnyCheckboxChecked = Array.from(checkboxes).some(checkbox => checkbox.checked);

              if (isAnyCheckboxChecked) {
                form.querySelector('#topics-container').classList.remove('is-invalid');
                form.querySelector('#topics-container .invalid-feedback').style.display = 'none';
              }
            }
          });

          // Initially hide invalid feedback for topics container
          form.querySelector('#topics-container .invalid-feedback').style.display = 'none';
        });
      });
    </script>


    <script>
      document.getElementById('generate_now').addEventListener('click', function() {
        document.getElementById('exam_gen_form_container').scrollIntoView({ behavior: 'smooth' });
      });
    </script>




   <script>
      document.addEventListener("DOMContentLoaded", function() {
          const form = document.getElementById("exam_gen_form");
          const generateExamSubmitBtn = document.getElementById("generate_exam_submit_btn");

          form.addEventListener("submit", function(event) {
              event.preventDefault(); 

              generateExamSubmitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" aria-hidden="true"></span> Generating...';
              generateExamSubmitBtn.disabled = true; 

              const formData = new FormData(form);
              const formJson = Object.fromEntries(formData.entries());

              formJson.instructions = [];
              document.querySelectorAll("#instructions-container input[type='checkbox']:checked").forEach(checkbox => {
                  formJson.instructions.push(checkbox.value);
              });

              formJson.topics = [];
              document.querySelectorAll("#topics-container input[type='checkbox']:checked").forEach(checkbox => {
                  formJson.topics.push(checkbox.value);
              });

              console.log("Form Data Collected:");
              console.log(JSON.stringify(formJson, null, 2));

              const csrfToken = document.querySelector('input[name="csrfmiddlewaretoken"]').value;

              console.log("CSRF Token:", csrfToken);

              fetch("{% url 'exam_data_preparation' %}", {
                  method: "POST",
                  headers: {
                      "Content-Type": "application/json",
                      "X-CSRFToken": csrfToken
                  },
                  body: JSON.stringify(formJson)
              })
              .then(response => response.json())
              .then(data => {
                  console.log("Response Data:", data);
                  if (data.status === 'success' && data.task_id) {
                      const previewUrl = "{% url 'generated_exam_preview' %}";
                      window.location.href = previewUrl;
                  } else {
                      console.error("Failed to retrieve task ID:", data);
                      generateExamSubmitBtn.innerHTML = 'Generate';
                      generateExamSubmitBtn.disabled = false;
                  }
              })
              .catch(error => {
                  console.error("Error:", error);
                  generateExamSubmitBtn.innerHTML = 'Generate';
                  generateExamSubmitBtn.disabled = false;
              });
          });
      });
  </script>







  </body>
</html>